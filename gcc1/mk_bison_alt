set -x
./mk_clean_bison

bd=../build/bison-1.00

set -e
cd bison-1.00
rm -r ${bd}
mkdir ${bd}

for i in LR0 allocate closure conflicts derives getargs gram lalr lex main nullable output print reader symtab warshall;
do
  cc -g -c -o ${bd}/$i.o $i.c
done

cc -c -g -DXPFILE=\"/tmp/gcc1/bison-1.00//lib/bison.simple\" -DXPFILE1=\"/tmp/gcc1/bison-1.00//lib/bison.hairy\" files.c
cc -g   -c -o getargs.o getargs.c
cc -g   -c -o gram.o gram.c
cc -g   -c -o lalr.o lalr.c
cc -g   -c -o lex.o lex.c
cc -g   -c -o main.o main.c
cc -g   -c -o nullable.o nullable.c
cc -g   -c -o output.o output.c
cc -g   -c -o print.o print.c
cc -g   -c -o reader.o reader.c
cc -g   -c -o symtab.o symtab.c
cc -g   -c -o warshall.o warshall.c

cp *o ${bd}

pushd .
cd ${bd}
cc  -o bison LR0.o allocate.o closure.o conflicts.o derives.o files.o getargs.o gram.o lalr.o lex.o main.o nullable.o output.o print.o reader.o symtab.o warshall.o
popd

cp ${bd}/bison .

cd ..

./mk_install_bison
echo "bison built and installed OK"
